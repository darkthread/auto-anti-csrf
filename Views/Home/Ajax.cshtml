<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Ajax Test</title>
    <style>
        html,
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
        }

        table {
            border-collapse: collapse;
        }

        td {
            border: 1px solid #ccc;
            padding: 5px;
        }
    </style>
</head>

<body>
    <div>
        <h1>AJAX Test</h1>
        <table>
            <tr>
                <td><label for="name">Name:</label></td>
                <td><input type="text" id="name" placeholder="Enter name" /></td>
            </tr>
            <tr>
                <td><label for="count">Count:</label></td>
                <td><input type="number" id="count" placeholder="Enter count" /></td>
            </tr>
            <tr>
                <td colspan="2" style="text-align: right;">
                    <button type="button" onclick="submitData()">Submit via AJAX</button>
                </td>
            </tr>
        </table>

        <p id="response"></p>
    </div>
    @Html.AntiForgeryToken()
    <script>
        function submitData() {
            const name = document.getElementById('name').value || 'N/A';
            const count = document.getElementById('count').value || '-1';
            const token = document.querySelector('input[name="__RequestVerificationToken"]')?.value;
            fetch('/Home/Ajax', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                    'RequestVerificationToken': token
                },
                body: JSON.stringify({ Name: name, Count: parseInt(count) })
            })
                .then(response => {
                    debugger;
                    if (!response.ok) {
                        throw new Error('HTTP error ' + response.status);
                    }
                    return response.text();
                })
                .then(result => {
                    showResponse(result);
                })
                .catch(error => {
                    showResponse('Error: ' + error.message);
                });
        }

        function showResponse(message) {
            document.getElementById('response').innerHTML = message;
        }
    </script>


</body>

</html>